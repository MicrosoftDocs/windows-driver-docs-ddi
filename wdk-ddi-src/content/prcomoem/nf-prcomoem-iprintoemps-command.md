---
UID: NF:prcomoem.IPrintOemPS.Command
title: IPrintOemPS::Command method
author: windows-driver-content
description: The IPrintOemPS::Command method is used by rendering plug-ins for the Microsoft PostScript printer driver, in order to insert PostScript commands into the print job's data stream.
old-location: print\iprintoemps_command.htm
old-project: print
ms.assetid: b79dd6e7-361c-4051-9e7c-18c64d459a70
ms.author: windowsdriverdev
ms.date: 2/26/2018
ms.keywords: Command method [Print Devices], Command method [Print Devices], IPrintOemPS interface, Command,IPrintOemPS.Command, IPrintOemPS, IPrintOemPS interface [Print Devices], Command method, IPrintOemPS::Command, prcomoem/IPrintOemPS::Command, print.iprintoemps_command, print_unidrv-pscript_rendering_ec087427-976b-4f71-9db9-a0c08f214907.xml
ms.prod: windows-hardware
ms.technology: windows-devices
ms.topic: method
req.header: prcomoem.h
req.include-header: Prcomoem.h
req.target-type: Desktop
req.target-min-winverclnt: 
req.target-min-winversvr: 
req.kmdf-ver: 
req.umdf-ver: 
req.ddi-compliance: 
req.unicode-ansi: 
req.idl: 
req.max-support: 
req.namespace: 
req.assembly: 
req.type-library: 
req.lib: 
req.dll: 
req.irql: 
topic_type:
-	APIRef
-	kbSyntax
api_type:
-	COM
api_location:
-	prcomoem.h
api_name:
-	IPrintOemPS.Command
product:
- Windows
targetos: Windows
req.typenames: OEMPTOPTS, *POEMPTOPTS
req.product: Windows 10 or later.
---

# IPrintOemPS::Command method


## -description


The <code>IPrintOemPS::Command</code> method is used by rendering plug-ins for the Microsoft PostScript printer driver, in order to insert PostScript commands into the print job's data stream.


## -parameters




### -param pdevobj

Caller-supplied pointer to a <a href="https://msdn.microsoft.com/library/windows/hardware/ff547573">DEVOBJ</a> structure.


### -param dwIndex

Caller-supplied value representing the current injection point within the print job's data stream. For more information, see the following Remarks section.


### -param pData

Not used.


### -param cbSize

Not used.


### -param pdwResult [out]

Receives a method-supplied value indicating the result of the insertion operation. If the insertion succeeds, this value should be ERROR_SUCCESS. If the insertion fails, the value should be one of the error codes defined in winerror.h. If the method does not attempt to insert data for a specified <i>dwIndex</i> value, the value should be ERROR_NOT_SUPPORTED.


## -returns



The method must return one of the following values.

<table>
<tr>
<th>Return code</th>
<th>Description</th>
</tr>
<tr>
<td width="40%">
<dl>
<dt><b>S_OK</b></dt>
</dl>
</td>
<td width="60%">
The operation succeeded.

</td>
</tr>
<tr>
<td width="40%">
<dl>
<dt><b>E_FAIL</b></dt>
</dl>
</td>
<td width="60%">
The operation failed

</td>
</tr>
<tr>
<td width="40%">
<dl>
<dt><b>E_NOTIMPL</b></dt>
</dl>
</td>
<td width="60%">
The method is not implemented.

</td>
</tr>
</table>
 




## -remarks



The <code>IPrintOemPS::Command</code> method is used to insert PostScript commands into the data stream that is generated by the <a href="https://msdn.microsoft.com/1c67d20c-ada6-42fd-a882-61e12b72611f">Microsoft PostScript Printer Driver</a>. If you want to provide this method, you must define it in a rendering plug-in.

When the <code>IPrintOemPS::Command</code> method is called, its <i>dwIndex</i> parameter specifies the current injection point within the print job's data stream. The method should use this value to determine what operation, if any, to perform. Index values, which are defined in wingdi.h, are listed in the following table.

<table>
<tr>
<th>Index value</th>
<th>When received</th>
</tr>
<tr>
<td>
PSINJECT_BEGINDEFAULTS

</td>
<td>
After the printer driver sends  <b>%%BeginDefaults</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_BEGINPAGESETUP

</td>
<td>
After the printer driver sends <b>%%BeginPageSetup</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_BEGINPROLOG

</td>
<td>
After the printer driver sends <b>%%BeginProlog</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_BEGINSETUP

</td>
<td>
After the printer driver sends <b>%%BeginSetup</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_BEGINSTREAM

</td>
<td>
Before the printer driver sends the first byte of the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_BOUNDINGBOX

</td>
<td>
When the printer driver is ready to insert <b>%%BoundingBox:</b> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%BoundingBox:</b> comment.

</td>
</tr>
<tr>
<td>
PSINJECT_COMMENTS

</td>
<td>
Before the printer driver sends <b>%%EndComments</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_DLFONT

</td>
<td>
Before the print driver downloads a soft font.

</td>
</tr>
<tr>
<td>
PSINJECT_DOCNEEDEDRES

</td>
<td>
After the printer driver sends <b>%%DocumentNeededResources:</b> to the data stream, along with resource information. If the <code>IPrintOemPS::Command</code> method sends resource information, it is appended to the stream after the driver's resource information. Entry format is as follows:

%%+ 
        <i>ResourceTypeResourceNames</i>

The printer driver sends <b>%%DocumentNeededResources: </b>after sending <b>%%Trailer</b> section.

</td>
</tr>
<tr>
<td>
PSINJECT_DOCSUPPLIEDRES

</td>
<td>
After the printer driver sends <b>%%DocumentSuppliedResources:</b> to the data stream, along with resource information. If the <code>IPrintOemPS::Command</code> method sends resource information, it is appended to the stream after the driver's resource information. Entry format is as follows:


        %%+ 
        <i>ResourceTypeResourceNames</i>

The printer driver sends <b>%%DocumentSuppliedResources:</b> after sending <b>%%Trailer</b> section.

</td>
</tr>
<tr>
<td colspan="2">
PSINJECT_DOCUMENTPROCESSCOLORS

</td>
</tr>
<tr>
<td></td>
<td>
When the printer driver is ready to insert <b>%%DocumentProcessColors:</b><i>color</i> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%DocumentProcessColors:</b><i>color</i> comment.

</td>
</tr>
<tr>
<td colspan="2">
PSINJECT_DOCUMENTPROCESSCOLORSATEND

</td>
</tr>
<tr>
<td></td>
<td>
When the printer driver is ready to insert <b>%%DocumentProcessColors:</b>(atend) into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%DocumentProcessColors:</b>(atend) comment.

</td>
</tr>
<tr>
<td>
PSINJECT_ENDDEFAULTS

</td>
<td>
Before the printer driver sends <b>%%EndDefaults</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_ENDPAGECOMMENTS

</td>
<td>
Before the printer driver sends <b>%%EndPageComments</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_ENDPAGESETUP

</td>
<td>
Before the printer driver sends <b>%%EndPageSetup</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_ENDPROLOG

</td>
<td>
Before the printer driver sends <b>%%EndProlog</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_ENDSETUP

</td>
<td>
Before the printer driver sends <b>%%EndSetup</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_ENDSTREAM

</td>
<td>
After the printer driver sends the last byte of the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_EOF

</td>
<td>
After the printer driver sends <b>%%EOF</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_ORIENTATION

</td>
<td>
When the printer driver is ready to insert <b>%%Orientation:</b> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%Orientation:</b> comment.

</td>
</tr>
<tr>
<td>
PSINJECT_PAGEBBOX

</td>
<td>
When the printer driver is ready to insert <b>%%PageBoundingBox:</b> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%PageBoundingBox:</b> comment.

</td>
</tr>
<tr>
<td>
PSINJECT_PAGENUMBER

</td>
<td>
When the printer driver is ready to insert <b>%%Page:</b> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%Page:</b> comment.

</td>
</tr>
<tr>
<td>
PSINJECT_PAGEORDER

</td>
<td>
When the printer driver is ready to insert <b>%%PageOrder:</b> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%PageOrder:</b> comment.

</td>
</tr>
<tr>
<td>
PSINJECT_PAGES

</td>
<td>
When the printer driver is ready to insert <b>%%Pages:</b><i>nnn</i> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%Pages:</b><i>nnn</i> comment.

</td>
</tr>
<tr>
<td>
PSINJECT_PAGESATEND

</td>
<td>
When the printer driver is ready to insert <b>%%Pages:</b>(atend) into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%Pages:</b>(atend) comment.

</td>
</tr>
<tr>
<td>
PSINJECT_PAGETRAILER

</td>
<td>
After the printer driver sends <code>%%PageTrailer</code> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_PLATECOLOR

</td>
<td>
When the printer driver is ready to insert <b>%%PlateColor:</b><i>color</i> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%PlateColor:</b><i>color</i> comment.

</td>
</tr>
<tr>
<td>
PSINJECT_PSADOBE

</td>
<td>
Before the printer driver sends <b>%!PS-Adobe</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_SHOWPAGE

</td>
<td>
Before the printer driver sends a <b>showpage</b> command.

</td>
</tr>
<tr>
<td>
PSINJECT_TRAILER

</td>
<td>
After the printer driver sends <b>%%Trailer</b> to the data stream.

</td>
</tr>
<tr>
<td>
PSINJECT_VMRESTORE

</td>
<td>
After the printer driver sends a <b>restore</b> command. (The <code>IPrintOemPS::Command</code> method must resend all resources it sent after the last PSINJECT_VMSAVE, if the resources are going to be reused.)

</td>
</tr>
<tr>
<td>
PSINJECT_VMSAVE

</td>
<td>
Before the printer driver sends a <b>save</b> command. (See PSINJECT_VMRESTORE.)

</td>
</tr>
</table>
 

The <code>IPrintOemPS::Command</code> method must call <a href="https://msdn.microsoft.com/library/windows/hardware/ff553103">IPrintOemDriverPS::DrvWriteSpoolBuf</a> to insert the PostScript commands.

If <code>IPrintOemPS::Command</code> methods are exported by multiple rendering plug-ins, the methods are called in the order that the plug-ins are specified for installation, every time that the printer driver reaches an injection point. The following rules apply:

<ul>
<li>
If the injection point is one for which supplied data is appended to the data that the printer driver provides, each plug-in is called and each plug-in is allowed to append PostScript commands.

</li>
<li>
If the injection point is one for which supplied data replaces the data that the printer driver provides, the plug-ins are called until one <code>IPrintOemPS::Command</code> method supplies ERROR_SUCCESS for <i>dwResult</i>. No other plug-ins are called. If all plug-ins supply ERROR_NOT_SUPPORTED, the driver-supplied data is not replaced.

</li>
<li>
If the injection point is one for which supplied data replaces the data that the printer driver provides, and if an application has already replaced the driver-supplied data by using the <a href="https://msdn.microsoft.com/c0133355-fa3b-4117-bd38-b6a8b3898f94">POSTSCRIPT_INJECTION</a> printer escape function, no plug-ins are called.

</li>
</ul>


