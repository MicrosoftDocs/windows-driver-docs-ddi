---
UID: NF:prcomoem.IPrintOemPS.Command
title: IPrintOemPS::Command method
author: windows-driver-content
description: The IPrintOemPS::Command method is used by rendering plug-ins for the Microsoft PostScript printer driver, in order to insert PostScript commands into the print job's data stream.
old-location: print\iprintoemps_command.htm
old-project: print
ms.assetid: b79dd6e7-361c-4051-9e7c-18c64d459a70
ms.author: windowsdriverdev
ms.date: 1/8/2018
ms.keywords: IPrintOemPS, IPrintOemPS::Command, Command
ms.prod: windows-hardware
ms.technology: windows-devices
ms.topic: method
req.header: prcomoem.h
req.include-header: Prcomoem.h
req.target-type: Desktop
req.target-min-winverclnt: 
req.target-min-winversvr: 
req.kmdf-ver: 
req.umdf-ver: 
req.alt-api: IPrintOemPS.Command
req.alt-loc: prcomoem.h
req.ddi-compliance: 
req.unicode-ansi: 
req.idl: 
req.max-support: 
req.namespace: 
req.assembly: 
req.type-library: 
req.lib: 
req.dll: 
req.irql: 
req.typenames: OEMPTOPTS, *POEMPTOPTS
req.product: Windows 10 or later.
---

# IPrintOemPS::Command method



## -description
The <code>IPrintOemPS::Command</code> method is used by rendering plug-ins for the Microsoft PostScript printer driver, in order to insert PostScript commands into the print job's data stream.



## -syntax

````
HRESULT Command(
        PDEVOBJ pdevobj,
        DWORD   dwIndex,
        PVOID   pData,
        DWORD   cbSize,
  [out] DWORD   *pdwResult
);
````


## -parameters

### -param pdevobj 

Caller-supplied pointer to a <a href="..\printoem\ns-printoem-_devobj.md">DEVOBJ</a> structure.


### -param dwIndex 

Caller-supplied value representing the current injection point within the print job's data stream. For more information, see the following Remarks section.


### -param pData 

Not used.


### -param cbSize 

Not used.


### -param pdwResult [out]

Receives a method-supplied value indicating the result of the insertion operation. If the insertion succeeds, this value should be ERROR_SUCCESS. If the insertion fails, the value should be one of the error codes defined in winerror.h. If the method does not attempt to insert data for a specified <i>dwIndex</i> value, the value should be ERROR_NOT_SUPPORTED.


## -returns
The method must return one of the following values.
<dl>
<dt><b>S_OK</b></dt>
</dl>The operation succeeded.
<dl>
<dt><b>E_FAIL</b></dt>
</dl>The operation failed
<dl>
<dt><b>E_NOTIMPL</b></dt>
</dl>The method is not implemented.

 


## -remarks
The <code>IPrintOemPS::Command</code> method is used to insert PostScript commands into the data stream that is generated by the <a href="https://msdn.microsoft.com/1c67d20c-ada6-42fd-a882-61e12b72611f">Microsoft PostScript Printer Driver</a>. If you want to provide this method, you must define it in a rendering plug-in.

When the <code>IPrintOemPS::Command</code> method is called, its <i>dwIndex</i> parameter specifies the current injection point within the print job's data stream. The method should use this value to determine what operation, if any, to perform. Index values, which are defined in wingdi.h, are listed in the following table.

PSINJECT_BEGINDEFAULTS

After the printer driver sends  <b>%%BeginDefaults</b> to the data stream.

PSINJECT_BEGINPAGESETUP

After the printer driver sends <b>%%BeginPageSetup</b> to the data stream.

PSINJECT_BEGINPROLOG

After the printer driver sends <b>%%BeginProlog</b> to the data stream.

PSINJECT_BEGINSETUP

After the printer driver sends <b>%%BeginSetup</b> to the data stream.

PSINJECT_BEGINSTREAM

Before the printer driver sends the first byte of the data stream.

PSINJECT_BOUNDINGBOX

When the printer driver is ready to insert <b>%%BoundingBox:</b> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%BoundingBox:</b> comment.

PSINJECT_COMMENTS

Before the printer driver sends <b>%%EndComments</b> to the data stream.

PSINJECT_DLFONT

Before the print driver downloads a soft font.

PSINJECT_DOCNEEDEDRES

After the printer driver sends <b>%%DocumentNeededResources:</b> to the data stream, along with resource information. If the <code>IPrintOemPS::Command</code> method sends resource information, it is appended to the stream after the driver's resource information. Entry format is as follows:

%%+ 
        <i>ResourceTypeResourceNames</i>

The printer driver sends <b>%%DocumentNeededResources: </b>after sending <b>%%Trailer</b> section.

PSINJECT_DOCSUPPLIEDRES

After the printer driver sends <b>%%DocumentSuppliedResources:</b> to the data stream, along with resource information. If the <code>IPrintOemPS::Command</code> method sends resource information, it is appended to the stream after the driver's resource information. Entry format is as follows:


        %%+ 
        <i>ResourceTypeResourceNames</i>

The printer driver sends <b>%%DocumentSuppliedResources:</b> after sending <b>%%Trailer</b> section.

PSINJECT_DOCUMENTPROCESSCOLORS

When the printer driver is ready to insert <b>%%DocumentProcessColors:</b><i>color</i> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%DocumentProcessColors:</b><i>color</i> comment.

PSINJECT_DOCUMENTPROCESSCOLORSATEND

When the printer driver is ready to insert <b>%%DocumentProcessColors:</b>(atend) into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%DocumentProcessColors:</b>(atend) comment.

PSINJECT_ENDDEFAULTS

Before the printer driver sends <b>%%EndDefaults</b> to the data stream.

PSINJECT_ENDPAGECOMMENTS

Before the printer driver sends <b>%%EndPageComments</b> to the data stream.

PSINJECT_ENDPAGESETUP

Before the printer driver sends <b>%%EndPageSetup</b> to the data stream.

PSINJECT_ENDPROLOG

Before the printer driver sends <b>%%EndProlog</b> to the data stream.

PSINJECT_ENDSETUP

Before the printer driver sends <b>%%EndSetup</b> to the data stream.

PSINJECT_ENDSTREAM

After the printer driver sends the last byte of the data stream.

PSINJECT_EOF

After the printer driver sends <b>%%EOF</b> to the data stream.

PSINJECT_ORIENTATION

When the printer driver is ready to insert <b>%%Orientation:</b> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%Orientation:</b> comment.

PSINJECT_PAGEBBOX

When the printer driver is ready to insert <b>%%PageBoundingBox:</b> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%PageBoundingBox:</b> comment.

PSINJECT_PAGENUMBER

When the printer driver is ready to insert <b>%%Page:</b> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%Page:</b> comment.

PSINJECT_PAGEORDER

When the printer driver is ready to insert <b>%%PageOrder:</b> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%PageOrder:</b> comment.

PSINJECT_PAGES

When the printer driver is ready to insert <b>%%Pages:</b><i>nnn</i> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%Pages:</b><i>nnn</i> comment.

PSINJECT_PAGESATEND

When the printer driver is ready to insert <b>%%Pages:</b>(atend) into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%Pages:</b>(atend) comment.

PSINJECT_PAGETRAILER

After the printer driver sends <code>%%PageTrailer</code> to the data stream.

PSINJECT_PLATECOLOR

When the printer driver is ready to insert <b>%%PlateColor:</b><i>color</i> into the data stream. Data supplied by <code>IPrintOemPS::Command</code> replaces the driver's <b>%%PlateColor:</b><i>color</i> comment.

PSINJECT_PSADOBE

Before the printer driver sends <b>%!PS-Adobe</b> to the data stream.

PSINJECT_SHOWPAGE

Before the printer driver sends a <b>showpage</b> command.

PSINJECT_TRAILER

After the printer driver sends <b>%%Trailer</b> to the data stream.

PSINJECT_VMRESTORE

After the printer driver sends a <b>restore</b> command. (The <code>IPrintOemPS::Command</code> method must resend all resources it sent after the last PSINJECT_VMSAVE, if the resources are going to be reused.)

PSINJECT_VMSAVE

Before the printer driver sends a <b>save</b> command. (See PSINJECT_VMRESTORE.)

The <code>IPrintOemPS::Command</code> method must call <a href="https://msdn.microsoft.com/library/windows/hardware/ff553103">IPrintOemDriverPS::DrvWriteSpoolBuf</a> to insert the PostScript commands.

If <code>IPrintOemPS::Command</code> methods are exported by multiple rendering plug-ins, the methods are called in the order that the plug-ins are specified for installation, every time that the printer driver reaches an injection point. The following rules apply:

If the injection point is one for which supplied data is appended to the data that the printer driver provides, each plug-in is called and each plug-in is allowed to append PostScript commands.

If the injection point is one for which supplied data replaces the data that the printer driver provides, the plug-ins are called until one <code>IPrintOemPS::Command</code> method supplies ERROR_SUCCESS for <i>dwResult</i>. No other plug-ins are called. If all plug-ins supply ERROR_NOT_SUPPORTED, the driver-supplied data is not replaced.

If the injection point is one for which supplied data replaces the data that the printer driver provides, and if an application has already replaced the driver-supplied data by using the <a href="https://msdn.microsoft.com/c0133355-fa3b-4117-bd38-b6a8b3898f94">POSTSCRIPT_INJECTION</a> printer escape function, no plug-ins are called.</p>